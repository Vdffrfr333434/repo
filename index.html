<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 50px;
      background: #f0f0f0;
    }

    #authBtn {
      padding: 12px 24px;
      font-size: 18px;
      border: none;
      background-color: #2a9df4;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }

    #authBtn:hover {
      background-color: #2388cc;
    }

    #status {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h1>
  <p>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ª–∏—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –æ—Ç–ø–µ—á–∞—Ç–æ–∫ –ø–∞–ª—å—Ü–∞ –∏–ª–∏ Face ID</p>
  <button id="authBtn">–í–æ–π—Ç–∏ —Å –±–∏–æ–º–µ—Ç—Ä–∏–µ–π</button>
  <div id="status"></div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const authBtn = document.getElementById("authBtn");
      const statusDiv = document.getElementById("status");

      async function authenticate() {
        if (!window.PublicKeyCredential) {
          statusDiv.textContent = "‚ùå WebAuthn –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.";
          return;
        }

        try {
          const challenge = Uint8Array.from("random_challenge_12345", c => c.charCodeAt(0));

          const publicKey = {
            challenge: challenge,
            timeout: 60000,
            userVerification: "preferred",
            allowCredentials: [] // –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –∑–¥–µ—Å—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ credentials
          };

          const credential = await navigator.credentials.get({ publicKey });

          console.log("‚úÖ –£—Å–ø–µ—à–Ω–æ:", credential);
          statusDiv.textContent = "‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!";
        } catch (err) {
          console.error("‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:", err);
          statusDiv.textContent = "‚ùå –û—à–∏–±–∫–∞: " + err.message;
        }
      }

      authBtn.addEventListener("click", authenticate);

      // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      authenticate();
    });
  </script>
</body>
</html>
